<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comparatore Offerte Luce Domestico</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f8f8f8; color: #333; line-height: 1.6; }
    h1 { text-align: center; color: #444; margin-bottom: 30px; }
    .input-section, .results-section { background-color: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 30px; max-width: 700px; margin-left: auto; margin-right: auto; }
    .input-group { margin-bottom: 18px; }
    .input-group label { display: block; margin-bottom: 8px; color: #555; font-weight: bold; }
    .input-group input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1rem; }
    button { display: block; width: 100%; background-color: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease; font-size: 1.1rem; margin-top: 20px; }
    button:hover { background-color: #0056b3; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
    th { background-color: #f2f2f2; font-weight: bold; color: #333; }
    tr:nth-child(even) { background-color: #f9f9f9; }
    tr:hover { background-color: #e9e9e9; }
    .print-button { display: block; width: auto; margin: 20px auto; padding: 10px 15px; background-color: #6c757d; border: none; color: white; border-radius: 5px; cursor: pointer; font-size: 1rem; text-align: center; }
    .print-button:hover { background-color: #5a6268; }
    #footer { text-align: center; padding-top: 20px; margin-top: 30px; border-top: 1px solid #ccc; color: #777; font-size: 0.9rem; }
  </style>
</head>
<body>
  <div id="header">
    <h1>GEDE SERVIZI - Offerte Luce Domestico</h1>
  </div>

  <div class="input-section">
    <h2>Inserisci i tuoi dati di consumo</h2>
    <div class="input-group">
      <label for="consumo">Consumo mensile (kWh):</label>
      <input type="number" id="consumo" value="225" step="0.01">
    </div>
    <div class="input-group">
      <label for="pun">PUN (€/kWh):</label>
      <input type="number" id="pun" value="0.12" step="0.001">
    </div>
    <button onclick="calcolaTutteLeOfferteLuce()">Calcola Offerte</button>
  </div>

  <div class="results-section">
    <h2 id="results-title">Risultati Comparazione Mensile Stimata</h2>
    <table id="risultati-tabella-luce">
      <thead>
        <tr>
          <th>Offerta</th>
          <th>Costo Materia Prima (€)</th>
          <th>Costi di Commercializzazione (€)</th>
          <th>Sconti/Bonus (€)</th>
          <th>Totale stimato (€)</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="window.print()" class="print-button">Stampa Risultati</button>
  </div>

  <div id="footer">
    <p>&copy; 2025 GEDE SERVIZI. Tutti i diritti riservati.</p>
  </div>

  <script>
    // ---------- ESTRA ----------
    function calcolaEstraFissa(consumo, pun) {
      // Prezzo fisso da contratto: 0,1562 €/kWh - Corrispettivo commerc.: 132 €/anno
      const prezzoFisso = 0.1562;
      const costoMateriaPrima = (consumo * prezzoFisso).toFixed(2);

      // 132 €/anno -> quota mensile
      const costiComm = (132 / 12).toFixed(2);

      // Sconto domiciliazione: 24 €/anno -> 2 €/mese
      const sconto = 2.00;

      const totale = (parseFloat(costoMateriaPrima) + parseFloat(costiComm) - sconto).toFixed(2);
      return {
        nome: "Estra Fissa Luce",
        costoMateriaPrima,
        costiCommercializzazione: costiComm,
        sconti: (-sconto).toFixed(2),
        totale
      };
    }

    function calcolaEstraNatura(consumo, pun) {
      // Spread contrattuale: 0,033 €/kWh
      const spread = 0.033;
      const costoMateriaPrima = (consumo * (pun + spread)).toFixed(2);

      // Corrispettivo fisso: 133,3151 €/anno -> quota mensile
      const costiComm = (133.3151 / 12).toFixed(2);

      // Sconto domiciliazione: 24 €/anno -> 2 €/mese
      const sconto = 2.00;

      const totale = (parseFloat(costoMateriaPrima) + parseFloat(costiComm) - sconto).toFixed(2);
      return {
        nome: "Estra Natura Luce",
        costoMateriaPrima,
        costiCommercializzazione: costiComm,
        sconti: (-sconto).toFixed(2),
        totale
      };
    }

    // ---------- CEI PLACET ----------
    function calcolaCei(consumo, pun, quotaMensile) {
      // CEI PLACET: Spread energia = 0, ma ci sono CcP + CsP + CrA = 0,01264 €/kWh
      const oneriVariabili = 0.01264;

      // PUN (input utente) + oneri variabili €/kWh
      const costoMateriaPrima = (consumo * (pun + oneriVariabili)).toFixed(2);

      // Quota fissa mensile (12, 15, 20 €/mese a seconda dell'offerta)
      const costiComm = quotaMensile.toFixed(2);

      const sconto = 0.00;
      const totale = (parseFloat(costoMateriaPrima) + parseFloat(costiComm) - sconto).toFixed(2);

      return {
        costoMateriaPrima,
        costiCommercializzazione: costiComm,
        sconti: (-sconto).toFixed(2),
        totale
      };
    }

    function calcolaCeiGo(consumo, pun) {
      // GO: 12 €/mese fissi
      const r = calcolaCei(consumo, pun, 12);
      r.nome = "CEI Go Luce";
      return r;
    }

    function calcolaCeiBoost(consumo, pun) {
      // BOOST: 15 €/mese fissi
      const r = calcolaCei(consumo, pun, 15);
      r.nome = "CEI Boost Luce";
      return r;
    }

    function calcolaCeiTurbo(consumo, pun) {
      // TURBO: 20 €/mese fissi
      const r = calcolaCei(consumo, pun, 20);
      r.nome = "CEI Turbo Luce";
      return r;
    }

    // ---------- CALCOLO TOTALE ----------
    function calcolaTutteLeOfferteLuce() {
      const consumo = parseFloat(document.getElementById('consumo').value);
      const pun = parseFloat(document.getElementById('pun').value);

      const offerte = [
        calcolaEstraFissa(consumo, pun),
        calcolaEstraNatura(consumo, pun),
        calcolaCeiTurbo(consumo, pun),
        calcolaCeiBoost(consumo, pun),
        calcolaCeiGo(consumo, pun)
      ];

      const tabellaBody = document
        .getElementById('risultati-tabella-luce')
        .getElementsByTagName('tbody')[0];

      tabellaBody.innerHTML = '';

      offerte.forEach(offerta => {
        const row = tabellaBody.insertRow();
        row.insertCell(0).textContent = offerta.nome;
        row.insertCell(1).textContent = `€${offerta.costoMateriaPrima}`;
        row.insertCell(2).textContent = `€${offerta.costiCommercializzazione}`;
        row.insertCell(3).textContent = `€${offerta.sconti}`;
        row.insertCell(4).textContent = `€${offerta.totale}`;
      });
    }

    window.onload = calcolaTutteLeOfferteLuce;
  </script>
</body>
</html>
